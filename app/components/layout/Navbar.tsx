'use client';

import { useAuth } from '../../context/AuthContext';
import { useTheme } from '../../context/ThemeContext';
import Link from 'next/link';
import { useRouter, usePathname } from 'next/navigation';
import { useState, useRef, useEffect } from 'react';
import { supabase } from '@/lib/supabase/client';
import AICommandPalette from '@/app/components/features/AIAssistant/AICommandPalette';
import FeedbackModal from '@/app/components/features/FeedbackModal';

export default function Navbar() {
    const { user, signOut } = useAuth();
    const { theme, setTheme } = useTheme();
    const router = useRouter();
    const pathname = usePathname();
    const [showDropdown, setShowDropdown] = useState(false);
    const [showAICommand, setShowAICommand] = useState(false);
    const [showFeedback, setShowFeedback] = useState(false);
    const [userAvatar, setUserAvatar] = useState<string | null>(null);
    const [userName, setUserName] = useState<string | null>(null);
    const dropdownRef = useRef<HTMLDivElement>(null);

    const handleSignOut = async () => {
        try {
            await signOut();
            setShowDropdown(false);
            router.push('/');
        } catch (err) {
            console.error('Error signing out:', err);
        }
    };

    // Fetch user profile
    useEffect(() => {
        const fetchUserProfile = async () => {
            if (user) {
                const { data } = await supabase
                    .from('profiles')
                    .select('avatar_url, name')
                    .eq('id', user.id)
                    .single();

                if (data) {
                    setUserAvatar(data.avatar_url);
                    setUserName(data.name);
                }
            }
        };

        fetchUserProfile();
    }, [user]);

    // Close dropdown when clicking outside
    useEffect(() => {
        const handleClickOutside = (event: MouseEvent) => {
            if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {
                setShowDropdown(false);
            }
        };

        document.addEventListener('mousedown', handleClickOutside);
        return () => document.removeEventListener('mousedown', handleClickOutside);
    }, []);

    // Keyboard shortcuts
    useEffect(() => {
        const handleKeyDown = (e: KeyboardEvent) => {
            // AI Command Palette (Cmd/Ctrl + K)
            if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
                e.preventDefault();
                setShowAICommand(true);
            }
            // Feedback Modal (Cmd/Ctrl + Shift + F)
            if ((e.metaKey || e.ctrlKey) && e.shiftKey && e.key === 'F') {
                e.preventDefault();
                setShowFeedback(true);
            }
        };

        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
    }, []);

    const navItems: Array<{
        name: string;
        href?: string;
        action?: () => void;
        icon: React.ReactNode;
        title?: string;
    }> = [
            {
                name: 'Home',
                href: '/dashboard',
                icon: (
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="Dashboard-3--Streamline-Flex-Remix" height="24" width="24">
                        <desc>
                            Dashboard 3 Streamline Icon: https://streamlinehq.com
                        </desc>
                        <g id="dashboard-3--app-application-dashboard-home-layout-vertical">
                            <path id="Union" fill="currentColor" fillRule="evenodd" d="M3.3939085714285713 2.828382857142857C4.2083828571428565 2.6886514285714287 4.967417142857143 2.571428571428571 5.725028571428571 2.571428571428571c0.7575942857142857 0 1.5166285714285714 0.11722285714285713 2.331085714285714 0.2569542857142857 0.32729142857142857 0.05614285714285714 0.5776628571428571 0.3342 0.6017828571428572 0.6555771428571427l0.01745142857142857 0.23206285714285713c0.10150285714285713 1.3482685714285714 0.20326285714285713 2.7000514285714283 0.20326285714285713 4.081937142857143 0 1.381902857142857 -0.10176 2.733685714285714 -0.20326285714285713 4.081954285714285l-0.01745142857142857 0.23207999999999998c-0.024119999999999996 0.32136 -0.27449142857142855 0.5994171428571429 -0.6017828571428572 0.65556 -0.8144571428571429 0.13973142857142856 -1.5734914285714283 0.2569542857142857 -2.331085714285714 0.2569542857142857 -0.7576114285714285 0 -1.5166457142857142 -0.11722285714285713 -2.33112 -0.2569542857142857 -0.3272742857142857 -0.05614285714285714 -0.5776457142857142 -0.3342 -0.6017657142857142 -0.65556l-0.01745142857142857 -0.23209714285714286C2.6731885714285712 10.531645714285714 2.571428571428571 9.179862857142856 2.571428571428571 7.797959999999999c0 -1.3818857142857144 0.10176 -2.7336685714285713 0.20326285714285713 -4.081902857142857l0.01745142857142857 -0.23209714285714286c0.024119999999999996 -0.32137714285714286 0.27449142857142855 -0.5994342857142857 0.6017657142857142 -0.6555771428571427ZM5.725028571428571 0.42857142857142855c-0.9592971428571428 0 -1.8797828571428572 0.148224 -2.6934342857142854 0.2878045714285714C1.744697142857143 0.9371434285714285 0.7537131428571429 2.0118342857142855 0.6552925714285713 3.323622857142857l-0.018824571428571427 0.25016571428571427C0.5360622857142857 4.906182857142857 0.42857142857142855 6.3325885714285715 0.42857142857142855 7.797959999999999c0 1.4653885714285713 0.10749085714285712 2.8917942857142855 0.20789657142857143 4.224188571428571l0.018824571428571427 0.25016571428571427c0.09842057142857141 1.3117885714285713 1.0894045714285714 2.3864742857142853 2.3763017142857144 2.60724 0.8136514285714285 0.1395942857142857 1.7341371428571426 0.28781142857142855 2.6934342857142854 0.28781142857142855 0.9592799999999999 0 1.8797657142857143 -0.14821714285714285 2.6934171428571427 -0.2877942857142857 1.2868971428571427 -0.22078285714285711 2.2778742857142853 -1.2954685714285714 2.3763085714285714 -2.6072571428571427l0.01882285714285714 -0.2502c0.10040571428571428 -1.332377142857143 0.20789142857142856 -2.758765714285714 0.20789142857142856 -4.2241542857142855 0 -1.4653542857142856 -0.1074857142857143 -2.8917599999999997 -0.20789142857142856 -4.224137142857143l-0.01882285714285714 -0.2502C10.696319999999998 2.0118342857142855 9.705342857142858 0.9371451428571429 8.418445714285713 0.7163759999999999 7.604794285714286 0.5767954285714285 6.684308571428571 0.42857142857142855 5.725028571428571 0.42857142857142855Zm10.218822857142857 10.803822857142857c0.8144742857142856 -0.1397142857142857 1.5735771428571428 -0.2569542857142857 2.33112 -0.2569542857142857 0.7575428571428571 0 1.5166285714285714 0.11724000000000001 2.331085714285714 0.2569542857142857 0.3272571428571428 0.05614285714285714 0.5777142857142857 0.3342 0.6017142857142856 0.6555771428571427l0.017485714285714285 0.23207999999999998c0.10148571428571429 1.3482514285714284 0.2033142857142857 2.7000342857142856 0.2033142857142857 4.081937142857143 0 1.3819542857142857 -0.10182857142857142 2.7336685714285713 -0.2033142857142857 4.081954285714285l-0.017485714285714285 0.2321142857142857c-0.024 0.32125714285714285 -0.27445714285714284 0.5993142857142857 -0.6017142857142856 0.6555428571428571 -0.8144571428571429 0.1397142857142857 -1.5735428571428571 0.2569714285714286 -2.331085714285714 0.2569714285714286 -0.7575428571428571 0 -1.5166457142857142 -0.11725714285714285 -2.331102857142857 -0.2569714285714286 -0.32729142857142857 -0.05622857142857143 -0.5776628571428571 -0.3342857142857143 -0.6017828571428572 -0.6555428571428571l-0.01745142857142857 -0.2321142857142857c-0.10150285714285713 -1.348285714285714 -0.20326285714285713 -2.7001714285714282 -0.20326285714285713 -4.081954285714285 0 -1.3818342857142856 0.10176 -2.733565714285714 0.20326285714285713 -4.081748571428571l0.01745142857142857 -0.2322685714285714c0.024119999999999996 -0.32137714285714286 0.27449142857142855 -0.5994342857142857 0.6017657142857142 -0.6555771428571427Zm2.33112 -2.3998114285714287c-0.9593142857142857 0 -1.8797828571428572 0.1482342857142857 -2.6934342857142854 0.28781142857142855 -1.2868971428571427 0.2207657142857143 -2.2778742857142853 1.2954514285714285 -2.3763085714285714 2.6072571428571427l-0.01882285714285714 0.25016571428571427c-0.10040571428571428 1.332377142857143 -0.20789142857142856 2.758782857142857 -0.20789142857142856 4.224171428571428 0 1.46544 0.1074857142857143 2.891725714285714 0.20789142857142856 4.22424l0.01882285714285714 0.2501142857142857c0.09843428571428571 1.3117714285714286 1.0894114285714285 2.3864571428571426 2.3763085714285714 2.6072571428571427 0.8136514285714285 0.13954285714285714 1.73412 0.2878285714285714 2.6934342857142854 0.2878285714285714 0.9593142857142857 0 1.8797142857142857 -0.14828571428571427 2.693485714285714 -0.2878285714285714 1.2867428571428572 -0.2208 2.2777714285714286 -1.2954857142857144 2.376171428571429 -2.6072571428571427l0.018857142857142854 -0.2502857142857143c0.10045714285714286 -1.332342857142857 0.20794285714285715 -2.7586285714285714 0.20794285714285715 -4.224068571428571 0 -1.4653542857142856 -0.1074857142857143 -2.891742857142857 -0.20794285714285715 -4.22412l-0.018857142857142854 -0.25021714285714286c-0.09839999999999999 -1.3118057142857142 -1.0894285714285712 -2.3864914285714285 -2.376171428571429 -2.6072571428571427 -0.8137714285714286 -0.13957714285714287 -1.7341714285714285 -0.28781142857142855 -2.693485714285714 -0.28781142857142855ZM15.680365714285713 0.5280977142857143C16.499725714285713 0.4782428571428571 17.374457142857143 0.42857142857142855 18.274971428571426 0.42857142857142855s1.7751428571428571 0.04967142857142857 2.5945714285714288 0.0995262857142857c1.2466285714285712 0.07585028571428572 2.4263999999999997 0.9867617142857142 2.6314285714285712 2.3379994285714285 0.04045714285714285 0.2675142857142857 0.07045714285714284 0.5585142857142856 0.07045714285714284 0.8651485714285713 0 0.3066342857142857 -0.030000000000000002 0.5976171428571427 -0.07045714285714284 0.8651314285714286 -0.20502857142857142 1.3512342857142856 -1.3847999999999998 2.262154285714286 -2.6314285714285712 2.3380114285714284 -0.8194285714285714 0.049851428571428574 -1.6940571428571427 0.09951428571428571 -2.5945714285714288 0.09951428571428571 -0.9005142857142856 0 -1.7752457142857143 -0.04966285714285714 -2.594605714285714 -0.09951428571428571 -1.2466457142857144 -0.07585714285714285 -2.4264342857142855 -0.9867771428571428 -2.631342857142857 -2.3380114285714284 -0.04057714285714285 -0.2675142857142857 -0.07050857142857142 -0.5584971428571429 -0.07050857142857142 -0.8651314285714286 0 -0.3066342857142857 0.02993142857142857 -0.5976342857142857 0.07050857142857142 -0.8651485714285713C13.253931428571429 1.5148594285714285 14.43372 0.6039479999999999 15.680365714285713 0.5280977142857143ZM5.725028571428571 16.965822857142857c-0.9005142857142856 0 -1.7752457142857143 0.04966285714285714 -2.594605714285714 0.09953142857142856 -1.2466457142857144 0.07584 -2.4264291428571427 0.9867599999999999 -2.631348 2.33796C0.45850457142857143 19.670914285714286 0.42857142857142855 19.96182857142857 0.42857142857142855 20.268514285714286c0 0.3066857142857143 0.029933142857142856 0.5976 0.07050342857142856 0.8652 0.20491885714285712 1.3512 1.3847022857142857 2.2619999999999996 2.631348 2.3379428571428567 0.81936 0.04988571428571428 1.6940914285714284 0.09942857142857142 2.594605714285714 0.09942857142857142 0.9004971428571429 0 1.7752285714285714 -0.04954285714285714 2.594588571428571 -0.09942857142857142 1.2466457142857144 -0.07594285714285713 2.4264342857142855 -0.9867428571428571 2.631342857142857 -2.3379428571428567 0.04057714285714285 -0.26759999999999995 0.07050857142857142 -0.5585142857142856 0.07050857142857142 -0.8652 0 -0.3066857142857143 -0.02993142857142857 -0.5976 -0.07050857142857142 -0.8652 -0.2049085714285714 -1.3512 -1.3846971428571428 -2.26212 -2.631342857142857 -2.33796 -0.81936 -0.04986857142857143 -1.6940914285714284 -0.09953142857142856 -2.594588571428571 -0.09953142857142856Z" clipRule="evenodd" strokeWidth="1.7143"></path>
                        </g>
                    </svg>
                )
            },
            {
                name: 'Search',
                action: () => setShowAICommand(true),
                icon: (
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="Magnifying-Glass--Streamline-Flex-Remix" height="24" width="24">
                        <desc>
                            Magnifying Glass Streamline Icon: https://streamlinehq.com
                        </desc>
                        <g id="magnifying-glass--glass-search-magnifying">
                            <path id="Union" fill="currentColor" fillRule="evenodd" d="M2.570588571428571 11.31798857142857c0 -2.945005714285714 0.8249657142857142 -5.094497142857143 2.2392342857142853 -6.508782857142857 1.4142685714285714 -1.4142685714285714 3.5637600000000003 -2.2392342857142853 6.508765714285714 -2.2392342857142853 2.9449885714285715 0 5.09448 0.8249657142857142 6.508782857142857 2.2392342857142853 1.4142857142857141 1.4142857142857141 2.2392 3.563777142857143 2.2392 6.508782857142857 0 2.945022857142857 -0.8249142857142857 5.094514285714285 -2.2392 6.508868571428571 -1.414302857142857 1.4142857142857141 -3.5637942857142852 2.2392 -6.508782857142857 2.2392 -2.945005714285714 0 -5.094497142857143 -0.8249142857142857 -6.508765714285714 -2.2392 -1.4142685714285714 -1.4143542857142857 -2.2392342857142853 -3.5638457142857143 -2.2392342857142853 -6.508868571428571Zm8.748 -10.890881142857141c-3.339445714285714 0 -6.0996685714285706 0.942534857142857 -8.02398857142857 2.8668754285714284C1.3702645714285713 5.21832 0.42773485714285714 7.97856 0.42773485714285714 11.31798857142857c0 3.339445714285714 0.9425297142857142 6.0996685714285706 2.866865142857143 8.023954285714286 1.9243199999999998 1.9244571428571429 4.684542857142857 2.8669714285714285 8.02398857142857 2.8669714285714285 2.7210342857142855 0 5.0575028571428575 -0.6258857142857143 6.870497142857142 -1.8985714285714284l2.8234285714285714 2.823257142857143c0.5857714285714285 0.5857714285714285 1.5354857142857143 0.5857714285714285 2.121257142857143 -0.00017142857142857143 0.5857714285714285 -0.5857714285714285 0.5857714285714285 -1.5354857142857143 0 -2.121257142857143l-2.823257142857143 -2.8230857142857144c1.2730285714285714 -1.813165714285714 1.8989142857142856 -4.149822857142857 1.8989142857142856 -6.871097142857143 0 -3.339428571428571 -0.9425142857142856 -6.0996685714285706 -2.8667999999999996 -8.024005714285714C17.41817142857143 1.3696422857142856 14.65801714285714 0.4271074285714286 11.31858857142857 0.4271074285714286Z" clipRule="evenodd" strokeWidth="1.7143"></path>
                        </g>
                    </svg>
                ),
                title: 'Search (⌘K)'
            },
            {
                name: 'Chat',
                href: '/chatbot',
                icon: (
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="Artificial-Intelligence-Spark--Streamline-Flex-Remix" height="24" width="24">
                        <desc>
                            Artificial Intelligence Spark Streamline Icon: https://streamlinehq.com
                        </desc>
                        <g id="artificial-intelligence-spark--brain-thought-ai-automated-ai">
                            <path id="Union" fill="currentColor" d="M7.577005714285715 3.7483199999999997c0.8808342857142858 0 1.7075999999999998 0.22985142857142857 2.424102857142857 0.6328114285714286C9.667525714285713 4.855919999999999 9.428571428571429 5.461405714285714 9.428571428571429 6.2142857142857135c0 0.13661142857142855 0.010217142857142857 0.2681142857142857 0.025114285714285714 0.39509142857142854 -0.4979485714285714 -0.44465142857142853 -1.1537314285714284 -0.7182 -1.87668 -0.7182 -1.5516685714285712 0.00020571428571428572 -2.805342857142857 1.2478971428571428 -2.8158514285714284 2.7840514285714284 0.00001714285714285714 0.0022285714285714283 0.0016799999999999999 0.004457142857142857 0.0016799999999999999 0.006685714285714285 0 0.04884 0.003257142857142857 0.09620571428571428 0.005022857142857142 0.14230285714285715l0.008365714285714285 0.1506685714285714c0.046697142857142854 0.5581714285714285 0.2240742857142857 0.9001371428571427 0.41184 1.125 0.17552571428571426 0.21001714285714285 0.40395428571428565 0.37097142857142856 0.6646114285714285 0.4955314285714285l0.2712171428571428 0.11384571428571427 0.19585714285714284 0.0937542857142857c0.4244571428571428 0.2612228571428571 0.6211885714285714 0.7942628571428572 0.44364000000000003 1.2806914285714286 -0.1778057142857143 0.4858114285714285 -0.67092 0.7648971428571427 -1.1635028571428572 0.6914057142857143l-0.21094285714285715 -0.05357142857142857 -0.45534857142857144 -0.18917142857142857c-0.4695942857142857 -0.2237657142857143 -0.9701657142857143 -0.5563028571428571 -1.3895142857142857 -1.0580399999999999 -0.13570285714285713 -0.16241142857142857 -0.2577085714285714 -0.3385542857142857 -0.3666171428571428 -0.5273485714285714 -0.6200742857142857 0.7691999999999999 -1.0345542857142855 1.8560399999999997 -1.0346057142857141 3.112165714285714 0.00013714285714285713 1.3033885714285713 0.45327428571428563 2.43924 1.12668 3.2175942857142856 0.5153657142857143 -0.2543485714285714 1.0778228571428572 -0.43505142857142853 1.6322571428571429 -0.4720628571428571l0.2126057142857143 -0.008365714285714285 0.2159657142857143 0.023434285714285713c0.48791999999999996 0.10069714285714285 0.8544857142857143 0.5336228571428571 0.8537828571428571 1.051337142857143 -0.001097142857142857 0.5172 -0.36934285714285714 0.9469714285714286 -0.8571428571428571 1.0464l-0.2159485714285714 0.02331428571428571 -0.17076 0.01337142857142857c-0.3275314285714286 0.048857142857142856 -0.7596685714285714 0.22508571428571428 -1.16184 0.4973142857142857 0.41429142857142853 1.388742857142857 1.7042914285714286 2.4056571428571427 3.23772 2.4056571428571427l0.34487999999999996 -0.0168c1.5991371428571428 -0.1614857142857143 2.864862857142857 -1.4341714285714284 3.016731428571428 -3.025028571428571l0.015068571428571426 -0.3214285714285714V8.69364c-0.00001714285714285714 -0.06594857142857143 -0.007182857142857143 -0.13104 -0.011725714285714284 -0.1958742857142857 0.3661885714285714 0.3698742857142857 0.7715142857142857 0.62664 1.0898571428571429 0.78348 0.38027999999999995 0.18733714285714284 0.79128 0.3297257142857143 1.0647257142857143 0.4252285714285714v8.770611428571428l0.016748571428571425 0.36171428571428565 0.046868571428571426 0.31302857142857143c0.3066857142857143 1.5390857142857142 1.6716685714285713 2.7049714285714286 3.313062857142857 2.7053142857142856 1.5386914285714284 0 2.82972 -1.0246285714285714 3.2394342857142853 -2.420742857142857 -0.3958285714285714 -0.2638285714285714 -0.8185714285714285 -0.43422857142857146 -1.1401714285714286 -0.4822285714285714l-0.1707428571428571 -0.01337142857142857 -0.216 -0.02331428571428571c-0.4876971428571429 -0.09942857142857142 -0.8559599999999999 -0.5291999999999999 -0.8570571428571429 -1.0464 -0.0007028571428571428 -0.5177142857142857 0.3658628571428571 -0.95064 0.8537999999999999 -1.051337142857143l0.216 -0.023434285714285713 0.21257142857142855 0.008365714285714285c0.5477142857142857 0.03654857142857142 1.103657142857143 0.21257142857142855 1.6138285714285714 0.4621199999999999 0.6694285714285714 -0.7782171428571427 1.1214857142857142 -1.9088057142857142 1.1216571428571427 -3.2076514285714284 0 -0.4292742857142857 -0.050571428571428566 -0.8382685714285714 -0.13902857142857142 -1.2220971428571428 0.07457142857142857 -0.12466285714285714 0.13885714285714285 -0.23964 0.18754285714285712 -0.34152 0.15377142857142856 -0.32118857142857143 0.30771428571428566 -0.7362685714285714 0.4068 -1.0044685714285715 0.1529142857142857 -0.41324571428571427 0.24548571428571425 -0.9928457142857142 0.6178285714285714 -1.2689657142857143 0.6817714285714286 1.0901314285714285 1.0697142857142856 2.426297142857143 1.0697142857142856 3.8370514285714283 -0.00017142857142857143 1.6936114285714285 -0.5571428571428572 3.2611371428571427 -1.4965714285714284 4.436451428571428C21.43062857142857 21.5388 18.95725714285714 24 15.912394285714285 24c-1.8263485714285712 -0.00034285714285714285 -3.444514285714286 -0.888 -4.449788571428571 -2.253428571428571 -0.952542857142857 1.2930857142857142 -2.453022857142857 2.1599999999999997 -4.161822857142857 2.246742857142857L7.016177142857142 24c-3.0447942857142856 0 -5.519951999999999 -2.4612 -5.521199999999999 -5.5043999999999995C0.5558742857142857 17.32045714285714 0.00013733485714285712 15.75234857142857 0 14.059148571428569 0.00006983931428571428 11.7888 1.0044154285714286 9.710845714285712 2.621657142857143 8.541291428571428c0.08161714285714285 -2.6631771428571427 2.271411428571428 -4.792714285714285 4.955348571428572 -4.792971428571429M17.934685714285713 0.010044651428571428c0.3320571428571429 0.047923919999999995 0.5556 0.24857591999999998 0.6713142857142856 0.3800222057142857 0.1344 0.15262285714285714 0.22868571428571427 0.3293965714285714 0.2946857142857143 0.467076 0.13114285714285714 0.2739925714285714 0.26537142857142854 0.6522754285714285 0.3867428571428571 0.9743314285714285 0.27205714285714283 0.7225542857142856 0.5742857142857143 1.418005714285714 1.0261714285714285 1.8699771428571426 0.4446857142857143 0.4446171428571428 1.1245714285714286 0.72264 1.8498857142857141 0.9826971428571427 0.32108571428571425 0.11513142857142857 0.7045714285714285 0.24478285714285714 0.9894857142857143 0.38504571428571427 0.14434285714285713 0.07117714285714286 0.3289714285714285 0.17670857142857144 0.4870285714285714 0.3297942857142857 0.16817142857142858 0.16289142857142855 0.36 0.4363714285714285 0.36 0.8152971428571428s-0.1918285714285714 0.6524057142857143 -0.36 0.8152971428571428c-0.15805714285714287 0.1530857142857143 -0.34268571428571426 0.2586171428571428 -0.4870285714285714 0.3297942857142857 -0.2849142857142857 0.14026285714285713 -0.6684 0.2699142857142857 -0.9894857142857143 0.38504571428571427 -0.7253142857142856 0.2600571428571428 -1.4052 0.53808 -1.8498857142857141 0.9826971428571427 -0.4518857142857143 0.4519714285714285 -0.7541142857142857 1.147422857142857 -1.0261714285714285 1.8699771428571426 -0.12137142857142857 0.32206285714285715 -0.2556 0.7003371428571429 -0.3867428571428571 0.9743314285714285 -0.06599999999999999 0.13767428571428572 -0.16028571428571428 0.31445142857142855 -0.2946857142857143 0.46707428571428566 -0.13217142857142858 0.15022285714285713 -0.40542857142857136 0.39003428571428567 -0.8202857142857142 0.3900685714285714 -0.4148571428571428 -0.00008571428571428571 -0.6880971428571429 -0.2398628571428571 -0.8203199999999999 -0.3900685714285714 -0.13427999999999998 -0.15262285714285714 -0.22870285714285712 -0.32939999999999997 -0.2946342857142857 -0.46707428571428566 -0.13114285714285714 -0.2740114285714286 -0.2654742857142857 -0.6522857142857142 -0.3867257142857143 -0.9743314285714285 -0.27207428571428566 -0.7226057142857143 -0.5742514285714285 -1.418005714285714 -1.026222857142857 -1.8699771428571426 -0.44473714285714283 -0.4446171428571428 -1.1245714285714286 -0.72264 -1.8498857142857141 -0.9826971428571427 -0.32110285714285713 -0.11513142857142857 -0.7045199999999999 -0.24480000000000002 -0.9894000000000001 -0.38504571428571427 -0.14456571428571427 -0.07122857142857142 -0.33077142857142855 -0.17657142857142855 -0.48884571428571433 -0.3297942857142857 -0.14682857142857142 -0.14256 -0.31105714285714287 -0.37004571428571426 -0.3498857142857143 -0.6780171428571428L11.571428571428571 6.2142857142857135l0.008365714285714285 -0.13727999999999999c0.03882857142857143 -0.30797142857142856 0.20305714285714285 -0.5354571428571429 0.3498857142857143 -0.6780171428571428 0.1580742857142857 -0.15322285714285713 0.34428 -0.25856571428571423 0.48884571428571433 -0.3297942857142857 0.28487999999999997 -0.14024571428571428 0.6682971428571428 -0.2699142857142857 0.9894000000000001 -0.38504571428571427 0.7253142857142856 -0.2600571428571428 1.4051485714285714 -0.53808 1.8498857142857141 -0.9826971428571427 0.4519714285714285 -0.4519714285714285 0.7541485714285714 -1.1473714285714285 1.026222857142857 -1.8699771428571426C16.405285714285714 1.5094354285714284 16.539617142857143 1.1311491428571427 16.670759999999998 0.8571428571428571c0.06593142857142857 -0.13767257142857142 0.1603542857142857 -0.31445142857142855 0.2946342857142857 -0.467076C17.097617142857143 0.23986971428571427 17.37085714285714 0.00008060108571428571 17.785714285714285 0z" strokeWidth="1.7143"></path>
                        </g>
                    </svg>
                )
            },
            {
                name: 'Graph',
                href: '/graph',
                icon: (
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="Hierarchy-3--Streamline-Flex-Remix" height="24" width="24">
                        <desc>
                            Hierarchy 3 Streamline Icon: https://streamlinehq.com
                        </desc>
                        <g id="hierarchy-3--node-organization-links-structure-link-nodes-network-hierarchy">
                            <path id="Union" fill="currentColor" fillRule="evenodd" d="M7.905342857142856 1.4767662857142856C8.91078857142857 0.471312 10.333662857142857 0 12 0s3.0892114285714287 0.471312 4.094657142857143 1.4767662857142856C17.10012 2.4822171428571425 17.57142857142857 3.905091428571428 17.57142857142857 5.571428571428571c0 1.4845885714285711 -0.37405714285714287 2.775925714285714 -1.166742857142857 3.750977142857143 1.4753142857142856 1.4416457142857142 2.5263428571428572 3.0562457142857142 3.2711999999999994 4.988502857142857 1.1905714285714286 0.09025714285714286 2.2429714285714284 0.4941085714285714 3.0265714285714287 1.2777085714285714 0.8981142857142858 0.8981314285714285 1.2973714285714286 2.1492685714285713 1.2973714285714286 3.5570399999999993 0 1.4077714285714287 -0.3992571428571428 2.658857142857143 -1.2973714285714286 3.5569714285714285S20.55325714285714 24 19.145485714285716 24c-1.4077714285714287 0 -2.6589428571428573 -0.3992571428571428 -3.5570914285714283 -1.2973714285714286 -0.6576685714285714 -0.6576 -1.0478399999999999 -1.5046285714285714 -1.2096171428571427 -2.4637714285714285 -1.59696 0.19885714285714284 -3.1607314285714283 0.19868571428571427 -4.757725714285714 -0.00017142857142857143 -0.16174285714285713 0.9591428571428571 -0.5519142857142857 1.8061714285714285 -1.2096514285714284 2.463942857142857 -0.8981314285714285 0.8981142857142858 -2.1492342857142854 1.2973714285714286 -3.5570057142857143 1.2973714285714286 -1.4077714285714287 0 -2.6588742857142855 -0.3992571428571428 -3.5570091428571424 -1.2973714285714286C0.39925028571428567 21.804514285714287 0 20.55342857142857 0 19.145657142857143c0 -1.4077714285714287 0.39925028571428567 -2.658908571428571 1.2973851428571428 -3.5570399999999993 0.7836377142857142 -0.7836514285714284 1.8360034285714284 -1.1874857142857143 3.0266777142857144 -1.2777085714285714 0.7448571428571428 -1.9322742857142856 1.796022857142857 -3.5468571428571427 3.2712514285714285 -4.988502857142857C6.80268 8.347337142857143 6.428571428571428 7.056017142857143 6.428571428571428 5.571428571428571c0 -1.6663371428571427 0.4713085714285714 -3.0892114285714287 1.4767714285714286 -4.094662285714286Zm1.4216742857142857 9.155028c-1.2249771428571428 1.1401885714285713 -2.1145542857142856 2.389405714285714 -2.7711942857142855 3.8853085714285713 0.7098685714285714 0.20573142857142857 1.340725714285714 0.5566457142857143 1.8555771428571426 1.0715142857142856 0.6634971428571428 0.66348 1.0547142857142855 1.5196114285714284 1.2138514285714286 2.4892114285714286 1.5995314285714284 0.22285714285714286 3.14976 0.2230285714285714 4.749257142857142 0.00017142857142857143 0.15911999999999998 -0.9696342857142857 0.5503542857142857 -1.8258514285714285 1.2138857142857142 -2.489382857142857 0.5149028571428571 -0.5149028571428571 1.1458285714285714 -0.8658342857142857 1.8558342857142858 -1.0715657142857142 -0.6567085714285713 -1.4958685714285713 -1.5462857142857143 -2.7450685714285714 -2.771245714285714 -3.8852571428571427C13.891971428571427 10.97688 12.988851428571428 11.142857142857142 12 11.142857142857142s-1.8919714285714284 -0.16597714285714285 -2.672982857142857 -0.5110628571428572ZM2.142857142857143 19.145657142857143c0 -1.0133142857142856 0.28169142857142854 -1.6537714285714284 0.6697542857142856 -2.0418171428571426 0.38808 -0.38808 1.0284514285714283 -0.6697542857142856 2.041782857142857 -0.6697542857142856 1.0133314285714285 0 1.653702857142857 0.2816742857142857 2.041782857142857 0.6697542857142856 0.38808 0.38804571428571427 0.6697542857142856 1.0285028571428572 0.6697542857142856 2.0418171428571426s-0.2816742857142857 1.6536 -0.6697542857142856 2.041714285714286c-0.38808 0.3881142857142857 -1.0284514285714283 0.6697714285714286 -2.041782857142857 0.6697714285714286 -1.0133314285714285 0 -1.653702857142857 -0.28165714285714283 -2.041782857142857 -0.6697714285714286 -0.3880628571428571 -0.3881142857142857 -0.6697542857142856 -1.0284 -0.6697542857142856 -2.041714285714286Zm14.960777142857141 -2.0418171428571426c-0.38808 0.38804571428571427 -0.6697542857142856 1.0285028571428572 -0.6697542857142856 2.0418171428571426s0.2816742857142857 1.6536 0.6697542857142856 2.041714285714286c0.38808 0.3881142857142857 1.028365714285714 0.6697714285714286 2.0418514285714284 0.6697714285714286 1.0133142857142856 0 1.6536 -0.28165714285714283 2.041714285714286 -0.6697714285714286 0.3881142857142857 -0.3881142857142857 0.6697714285714286 -1.0284 0.6697714285714286 -2.041714285714286 0 -1.0133142857142856 -0.28165714285714283 -1.6537714285714284 -0.6697714285714286 -2.0418171428571426 -0.3881142857142857 -0.38808 -1.0284 -0.6697542857142856 -2.041714285714286 -0.6697542857142856 -1.013485714285714 0 -1.6537714285714284 0.2816742857142857 -2.0418514285714284 0.6697542857142856Z" clipRule="evenodd" strokeWidth="1.7143"></path>
                        </g>
                    </svg>
                )
            },
            {
                name: 'Projects',
                href: '/projects',
                icon: (
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="Cube--Streamline-Flex-Remix" height="24" width="24">
                        <desc>
                            Cube Streamline Icon: https://streamlinehq.com
                        </desc>
                        <g id="cube">
                            <path id="Union" fill="currentColor" fillRule="evenodd" d="m13.071428571428571 11.917885714285713 8.17457142857143 -3.927154285714286c0.25457142857142856 3.039908571428571 0.24857142857142855 5.5844057142857135 -0.053657142857142855 8.6778 -0.017828571428571426 0.18198857142857142 -0.11777142857142855 0.34752 -0.2729142857142857 0.4487485714285714 -2.692628571428571 1.7559771428571427 -5.010085714285714 2.9606057142857143 -7.848 3.9763199999999994l0 -9.175714285714285Zm-2.142857142857143 0.00017142857142857143L2.7537942857142856 7.987457142857142c-0.25464 3.041142857142857 -0.2481428571428571 5.586462857142857 0.054394285714285714 8.681057142857142 0.017794285714285714 0.18198857142857142 0.11771999999999999 0.3475371428571428 0.27299999999999996 0.4488171428571428C5.774125714285714 18.873771428571427 8.090434285714286 20.0784 10.928571428571429 21.094285714285714l0 -9.176228571428572ZM12.863674285714284 0.5683285714285714c-0.5609485714285715 -0.18634285714285714 -1.168422857142857 -0.18634457142857141 -1.7293714285714283 0.00000342857142857143C7.684697142857142 1.7142685714285715 5.0112 3.0655714285714284 1.9158685714285715 5.083868571428572c-0.7044942857142857 0.45935999999999994 -1.159506857142857 1.2149999999999999 -1.2376251428571428 2.0503714285714287C0.3544868571428571 10.596411428571427 0.3372737142857143 13.417337142857143 0.6754971428571428 16.877005714285712c0.08122971428571428 0.83088 0.5362045714285714 1.5793371428571428 1.2350571428571429 2.035165714285714l0.5853085714285714 -0.8974285714285714 -0.5853085714285714 0.8974285714285714c3.097645714285714 2.0202857142857145 5.772085714285714 3.3728571428571428 9.223851428571429 4.519542857142857 0.5609657142857143 0.18634285714285714 1.168422857142857 0.18634285714285714 1.7293714285714283 0 3.4518171428571427 -1.1466857142857143 6.128108571428571 -2.499085714285714 9.226165714285713 -4.519542857142857 0.6989142857142857 -0.45582857142857147 1.1538857142857142 -1.2042857142857142 1.2349714285714286 -2.0352 0.33822857142857143 -3.459805714285714 0.3202285714285714 -6.280542857142857 -0.0035999999999999995 -9.742508571428571 -0.07817142857142857 -0.8353371428571428 -0.5331428571428571 -1.5909771428571426 -1.2377142857142855 -2.0503371428571424C18.987942857142855 3.0657599999999996 16.313331428571427 1.714266857142857 12.863674285714284 0.5683285714285714Z" clipRule="evenodd" strokeWidth="1.7143"></path>
                        </g>
                    </svg>
                )
            },
            {
                name: 'Project Board',
                href: '/project-board',
                icon: (
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="Clipboard-Add--Streamline-Flex-Remix" height="24" width="24">
                        <desc>
                            Clipboard Add Streamline Icon: https://streamlinehq.com
                        </desc>
                        <g id="clipboard-add--edit-task-edition-add-clipboard-form">
                            <path id="Union" fill="currentColor" fillRule="evenodd" d="M7.20762857142857 0.990042857142857c-0.5422971428571428 0.48574114285714287 -0.8557885714285713 1.11606 -0.9702514285714285 1.8167057142857141 -0.19976571428571427 0.020725714285714285 -0.39013714285714285 0.041057142857142855 -0.5342571428571428 0.05845714285714285 -0.40366285714285716 0.04872 -0.8011371428571429 0.09668571428571428 -1.195062857142857 0.14213142857142855 -1.31052 0.15118285714285715 -2.394325714285714 1.1908971428571429 -2.49648 2.555828571428571 -0.39638914285714283 5.296165714285714 -0.39638914285714283 10.298622857142856 0 15.59472 0.10172571428571428 1.359257142857143 1.1874342857142857 2.4241714285714284 2.5364914285714284 2.532857142857143 5.116645714285714 0.41228571428571426 9.787217142857141 0.41228571428571426 14.903931428571429 0 1.3489714285714285 -0.10868571428571427 2.434628571428571 -1.1736 2.536457142857143 -2.532857142857143 0.3963428571428571 -5.296079999999999 0.3963428571428571 -10.298554285714285 0 -15.594702857142856 -0.10217142857142857 -1.3649485714285714 -1.185942857142857 -2.4046628571428568 -2.4965142857142855 -2.5558457142857143 -0.39394285714285715 -0.045445714285714284 -0.7913142857142856 -0.09341142857142856 -1.1950285714285716 -0.14213142857142855 -0.13885714285714285 -0.016765714285714287 -0.3305142857142857 -0.03702857142857143 -0.5334857142857142 -0.05782285714285715 -0.11434285714285713 -0.7009028571428572 -0.42788571428571426 -1.3314531428571428 -0.9703028571428571 -1.8173382857142857 -0.67932 -0.6084702857142857 -1.590582857142857 -0.8759703428571428 -2.5673142857142857 -0.9132846857142858 -0.3979371428571428 -0.01520262857142857 -0.71676 -0.028147199999999997 -0.9799542857142858 -0.03883337142857143l-0.00001714285714285714 -6.8571428571429e-7C12.62310857142857 0.012642017142857141 12.311742857142857 0 12.000377142857142 0c-0.3113657142857143 0 -0.6227314285714286 0.012642017142857141 -1.24548 0.037926 -0.2631942857142857 0.010686342857142856 -0.5820171428571428 0.023630742857142853 -0.9799542857142858 0.038833542857142855 -0.9767314285714286 0.03731434285714286 -1.8879942857142855 0.30481302857142856 -2.5673142857142857 0.9132833142857143ZM5.95986857142857 4.992634285714286c0.18056571428571427 -0.021805714285714286 0.35799428571428565 -0.04056 0.5377714285714285 -0.058834285714285714 0.16594285714285714 0.35720571428571424 0.4007828571428571 0.6811885714285714 0.7099885714285713 0.9581485714285713 0.67932 0.6084685714285714 1.590582857142857 0.8759657142857142 2.5673142857142857 0.9132685714285713 0.3978342857142857 0.015205714285714284 0.7165885714285714 0.02814857142857143 0.9797485714285714 0.03882857142857143l0.00022285714285714283 0.00001714285714285714c0.6227314285714286 0.025285714285714283 0.9340971428571427 0.03792 1.2454628571428572 0.03792 0.3113657142857143 0 0.6227314285714286 -0.012634285714285712 1.2454457142857143 -0.03792l0.00005142857142857143 0 0.00003428571428571428 0c0.26317714285714283 -0.010697142857142856 0.5819828571428571 -0.023639999999999998 0.979902857142857 -0.03884571428571428 0.9767314285714286 -0.037302857142857145 1.8879942857142855 -0.3048 2.5673142857142857 -0.9132685714285713 0.30905142857142853 -0.27682285714285715 0.5437885714285714 -0.6006171428571428 0.7097314285714286 -0.9576171428571429 0.17828571428571427 0.017811428571428572 0.35468571428571427 0.036257142857142856 0.5372571428571429 0.058302857142857135l0.0015428571428571427 0.00017142857142857143c0.40217142857142857 0.04854857142857143 0.8046857142857142 0.09713142857142856 1.2046285714285714 0.14326285714285714 0.3512571428571428 0.04050857142857143 0.5843999999999999 0.3076285714285714 0.6053142857142857 0.58704 0.3882857142857143 5.189674285714285 0.3882857142857143 10.085228571428571 0 15.274834285714286 -0.02142857142857143 0.2852571428571428 -0.2533714285714285 0.5312571428571429 -0.5717142857142857 0.5569714285714286 -5.002165714285714 0.4030285714285714 -9.557605714285714 0.4030285714285714 -14.559702857142856 0 -0.31836 -0.02571428571428571 -0.5503885714285714 -0.2717142857142857 -0.5717314285714284 -0.5569714285714286 -0.38840571428571424 -5.189605714285714 -0.38840571428571424 -10.085159999999998 0 -15.274834285714286 0.020914285714285715 -0.27941142857142853 0.2540571428571428 -0.5465314285714286 0.6051771428571429 -0.58704 0.3999257142857143 -0.046131428571428566 0.8024571428571429 -0.09471428571428571 1.2046114285714287 -0.14324571428571428l0.00022285714285714283 -0.00003428571428571428 0.0014057142857142855 -0.00015428571428571428Zm4.7543999999999995 5.18364c0 -0.7100914285714285 0.5756228571428571 -1.2857142857142856 1.2857142857142856 -1.2857142857142856 0.7100742857142858 0 1.2857142857142856 0.5756228571428571 1.2857142857142856 1.2857142857142856v2.571428571428571H15.857142857142856c0.7100742857142858 0 1.2857142857142856 0.5756228571428571 1.2857142857142856 1.2857142857142856 0 0.7100742857142858 -0.5756399999999999 1.2857142857142856 -1.2857142857142856 1.2857142857142856H13.285697142857142v2.571497142857143c0 0.7100571428571428 -0.5756399999999999 1.2857142857142856 -1.2857142857142856 1.2857142857142856 -0.7100914285714285 0 -1.2857142857142856 -0.5756571428571428 -1.2857142857142856 -1.2857142857142856V15.319131428571426H8.142857142857142c-0.7100742857142858 0 -1.2857142857142856 -0.5756399999999999 -1.2857142857142856 -1.2857142857142856 0 -0.7100914285714285 0.5756399999999999 -1.2857142857142856 1.2857142857142856 -1.2857142857142856h2.5714114285714285v-2.571428571428571Z" clipRule="evenodd" strokeWidth="1.7143"></path>
                        </g>
                    </svg>
                )
            },
            {
                name: 'Notifications',
                href: '/notifications',
                icon: (
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="Bell-Notification--Streamline-Flex-Remix" height="24" width="24">
                        <desc>
                            Bell Notification Streamline Icon: https://streamlinehq.com
                        </desc>
                        <g id="bell-notification--alert-bell-ring-notification-alarm">
                            <path id="Union" fill="currentColor" fillRule="evenodd" d="M11.999948571428572 0.21428571428571427c-2.370205714285714 0 -4.372457142857143 0.6756428571428571 -5.780228571428571 2.0948399999999996 -1.4064857142857143 1.4179199999999998 -2.0743714285714288 3.43176 -2.0743714285714288 5.814874285714286 0 0.9438857142857142 -0.13796571428571427 1.4779542857142856 -0.28494857142857144 1.8035142857142854 -0.1406742857142857 0.31160571428571426 -0.3222514285714286 0.5094 -0.5853771428571428 0.7519542857142856 -0.03281142857142857 0.030257142857142854 -0.06958285714285714 0.06325714285714286 -0.10943999999999998 0.09903428571428571 -0.25285714285714284 0.22691999999999996 -0.6303428571428572 0.5656971428571428 -0.9121371428571428 1.0229485714285713C1.8982114285714287 12.377862857142857 1.7142857142857142 13.077479999999998 1.7142857142857142 14.000468571428572c0 1.2580971428571428 0.6964114285714286 2.179045714285714 1.5634285714285714 2.8031828571428568 0.8442685714285714 0.6078342857142857 1.9318457142857144 1.0033199999999998 2.9961599999999997 1.2705771428571428 2.1414685714285713 0.5376 4.545548571428571 0.6413142857142856 5.726074285714285 0.6413142857142856 1.1805085714285712 0 3.58464 -0.10354285714285714 5.726108571428571 -0.6413142857142856 1.0644 -0.26725714285714286 2.151942857142857 -0.6627428571428571 2.9962285714285715 -1.27056 0.8670857142857142 -0.6241371428571428 1.5634285714285714 -1.545102857142857 1.5634285714285714 -2.8032 0 -0.9230057142857142 -0.18394285714285713 -1.62264 -0.5391428571428571 -2.1990514285714284 -0.2818285714285714 -0.45726857142857136 -0.6593142857142856 -0.7960457142857142 -0.9121714285714285 -1.0229485714285713 -0.03994285714285714 -0.035777142857142855 -0.07662857142857142 -0.06877714285714286 -0.10954285714285714 -0.09901714285714285 -0.2631428571428571 -0.24257142857142855 -0.4446857142857143 -0.44034857142857137 -0.5854285714285714 -0.7519371428571429 -0.1469142857142857 -0.32555999999999996 -0.2849142857142857 -0.8596114285714285 -0.2849142857142857 -1.8035142857142854 0 -2.3831142857142855 -0.6678857142857143 -4.396954285714286 -2.0742857142857143 -5.814874285714286C16.372405714285716 0.8899285714285713 14.370154285714285 0.21428571428571427 11.999948571428572 0.21428571428571427ZM6.288205714285714 8.123999999999999c0 -1.993388571428571 0.5530799999999999 -3.3986914285714285 1.4528742857142856 -4.305788571428571 0.8985085714285713 -0.9058114285714286 2.2878514285714284 -1.4610685714285714 4.258868571428571 -1.4610685714285714s3.36036 0.5552571428571429 4.258868571428571 1.4610685714285714c0.8998114285714285 0.9070971428571429 1.45284 2.3124 1.45284 4.305788571428571 0 1.1438057142857143 0.16594285714285714 2.001222857142857 0.47485714285714287 2.6852914285714284 0.31508571428571425 0.69804 0.7414285714285713 1.1280171428571428 1.0859999999999999 1.445725714285714 0.05914285714285714 0.054514285714285717 0.11279999999999998 0.10340571428571428 0.1614857142857143 0.14795999999999998 0.2542285714285714 0.23194285714285715 0.3795428571428571 0.34635428571428567 0.4882285714285714 0.5227371428571428 0.10062857142857143 0.1632 0.22062857142857142 0.45005142857142855 0.22062857142857142 1.0747542857142858 0 0.35888571428571425 -0.16937142857142856 0.70188 -0.6725142857142856 1.0640914285714287 -0.5259428571428572 0.37859999999999994 -1.3129714285714285 0.6919028571428572 -2.2661142857142855 0.9312857142857143 -1.8937542857142855 0.47552571428571433 -4.0968 0.5767714285714286 -5.20428 0.5767714285714286 -1.10748 -0.00001714285714285714 -3.3104914285714284 -0.10126285714285713 -5.204159999999999 -0.5767885714285713 -0.9532457142857143 -0.23938285714285712 -1.7402228571428573 -0.5526857142857143 -2.2661314285714282 -0.9312685714285713 -0.5031428571428571 -0.3622114285714286 -0.6725142857142856 -0.7052057142857143 -0.6725142857142856 -1.0640914285714287 0 -0.6246857142857143 0.11996571428571429 -0.9115371428571428 0.2205428571428571 -1.0747542857142858 0.10870285714285713 -0.17638285714285712 0.23408571428571429 -0.2907942857142857 0.4882114285714285 -0.5227371428571428 0.04884 -0.04455428571428571 0.10242857142857142 -0.09346285714285714 0.16157142857142856 -0.14797714285714283 0.34464 -0.3177257142857143 0.7708285714285714 -0.7477028571428571 1.0859657142857142 -1.4457428571428572 0.3088457142857142 -0.6840514285714285 0.4747714285714285 -1.5414685714285714 0.4747714285714285 -2.6852571428571426Zm2.99472 11.902114285714285c-0.3533314285714285 0 -0.6839657142857143 0.17434285714285713 -0.8837314285714286 0.46577142857142856 -0.19978285714285715 0.2914285714285714 -0.24301714285714285 0.6625714285714286 -0.11559428571428572 0.9922285714285713 0.2838685714285714 0.7340571428571429 0.7709999999999999 1.3313142857142857 1.4432914285714284 1.7338285714285715 0.660822857142857 0.3954857142857142 1.440582857142857 0.5677714285714285 2.272662857142857 0.5677714285714285 0.8320799999999999 0 1.61184 -0.1722857142857143 2.272662857142857 -0.5677714285714285 0.6722914285714285 -0.4025142857142857 1.159422857142857 -0.9997714285714286 1.4432914285714284 -1.7338285714285715 0.12742285714285712 -0.3296571428571428 0.08418857142857143 -0.7008 -0.11559428571428572 -0.9922285714285713 -0.19976571428571427 -0.2914285714285714 -0.5303828571428572 -0.46577142857142856 -0.8837314285714286 -0.46577142857142856h-5.433257142857142Z" clipRule="evenodd" strokeWidth="1.7143"></path>
                        </g>
                    </svg>
                )
            },
        ];

    const isActive = (href: string) => {
        if (href === '/') {
            return pathname === href;
        }
        return pathname.startsWith(href);
    };

    return (
        <div className="hidden md:flex fixed left-0 top-0 h-full w-16 bg-background border-r border-border flex-col justify-between items-center py-4 z-50">
            {/* Logo */}
            <Link className="p-2 bg-primary rounded-xl transition-colors relative group text-white dark:text-background" href="/">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="Earth-1--Streamline-Flex-Remix" height="24" width="24">
                    <desc>
                        Earth 1 Streamline Icon: https://streamlinehq.com
                    </desc>
                    <g id="earth-1--planet-earth-globe-world">
                        <path id="Union" fill="currentColor" fillRule="evenodd" d="M14.261982857142856 2.3047028571428574c0.07179428571428571 0.6572228571428571 0.10616571428571428 1.3409828571428573 0.05595428571428571 2.003091428571428 -0.08259428571428572 1.0887942857142856 -0.3978342857142857 2.16948 -1.202622857142857 2.9742514285714283 -0.62736 0.62736 -1.4782457142857142 0.9798171428571427 -2.3654571428571427 0.9798171428571427 -0.6598971428571428 0 -1.29276 0.2621314285714285 -1.7593885714285715 0.728742857142857 -0.4666114285714285 0.4666285714285714 -0.72876 1.0994914285714286 -0.72876 1.7593885714285715v2.5000285714285715c0 0.8872285714285713 -0.35244 1.7381142857142857 -0.9798 2.365474285714286 -1.0711371428571428 1.07112 -2.61456 1.6137599999999999 -4.178708571428571 1.424862857142857 0.4063885714285714 0.8938114285714286 0.9338914285714285 1.6558114285714285 1.5672685714285715 2.28924C6.273291428571428 20.93228571428571 8.700068571428572 21.857142857142858 12 21.857142857142858c2.6226342857142857 0 4.693765714285714 -0.5840571428571428 6.2381142857142855 -1.6285714285714283v-1.1453142857142857c0 -0.43885714285714283 -0.17434285714285713 -0.8597142857142855 -0.48479999999999995 -1.17 -0.3102857142857143 -0.3104571428571429 -0.7311599999999999 -0.48479999999999995 -1.1700342857142856 -0.48479999999999995 -0.8872285714285713 0 -1.7381142857142857 -0.35237142857142856 -2.365474285714286 -0.9797314285714285 -0.62736 -0.62736 -0.9798 -1.4782457142857142 -0.9798 -2.365474285714286 0 -0.8872114285714285 0.35244 -1.7380971428571428 0.9798 -2.3654571428571427 0.4925828571428571 -0.4926 1.1831314285714285 -0.8021999999999999 1.9316399999999998 -0.9862971428571428 0.7530171428571428 -0.18521142857142855 1.5985542857142856 -0.2518457142857143 2.43924 -0.23304 1.1288571428571428 0.025234285714285713 2.2856571428571426 0.20578285714285713 3.237942857142857 0.48665142857142857 -0.17211428571428572 -2.787702857142857 -1.0633714285714284 -4.880828571428571 -2.497028571428571 -6.314639999999999 -1.2114857142857143 -1.2114171428571427 -2.8935942857142853 -2.035525714285714 -5.067617142857142 -2.3657657142857142Zm-11.106737142857142 0.850542857142857C5.268137142857142 1.0423542857142858 8.305645714285715 0 12 0s6.73182857142857 1.0423542857142858 8.844685714285713 3.155245714285714C22.95771428571428 5.268137142857142 24 8.305645714285715 24 12s-1.0422857142857143 6.73182857142857 -3.1553142857142857 8.844685714285713C18.73182857142857 22.95771428571428 15.694354285714285 24 12 24c-3.6943542857142857 0 -6.731862857142857 -1.0422857142857143 -8.844754285714286 -3.1553142857142857C1.0423542857142858 18.73182857142857 0 15.694354285714285 0 12c0 -3.6943542857142857 1.0423542857142858 -6.731862857142857 3.155245714285714 -8.844754285714286Z" clipRule="evenodd" strokeWidth="1.7143"></path>
                    </g>
                </svg>
            </Link>

            {/* Navigation Items */}
            <nav className="flex flex-col gap-2">
                {navItems.map((item) => {
                    const isActiveItem = item.href ? isActive(item.href) : false;
                    const className = `p-3 rounded-lg transition-colors relative group ${isActiveItem
                        ? 'bg-primary/10 text-primary'
                        : 'text-onsurface-secondary hover:bg-surface-container-muted hover:text-onsurface-primary'
                        }`;

                    if (item.action) {
                        return (
                            <button
                                key={item.name}
                                onClick={item.action}
                                title={item.title || item.name}
                                className={className}
                            >
                                {item.icon}
                                {item.title && (
                                    <div className="absolute left-full ml-2 px-2 py-1 bg-surface-container rounded text-xs text-onsurface-primary opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap">
                                        ⌘K
                                    </div>
                                )}
                            </button>
                        );
                    }

                    return (
                        <Link
                            key={item.name}
                            href={item.href!}
                            title={item.name}
                            className={className}
                        >
                            {item.icon}
                        </Link>
                    );
                })}
            </nav>

            {/* User Section */}
            <div className="relative" ref={dropdownRef}>
                {user ? (
                    <>
                        <button
                            onClick={() => setShowDropdown(!showDropdown)}
                            title="Profile"
                            className="cursor-pointer transition-transform"
                        >
                            {userAvatar ? (
                                <img
                                    src={userAvatar}
                                    alt="Profile"
                                    className="w-8 h-8 rounded-full object-cover"
                                />
                            ) : userName ? (
                                <div className="w-8 h-8 rounded-full bg-avatar-bg flex items-center justify-center text-xs font-medium text-onsurface-secondary">
                                    {userName.charAt(0).toUpperCase()}
                                </div>
                            ) : (
                                <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                </svg>
                            )}
                        </button>

                        {/* Dropdown Menu */}
                        {showDropdown && (
                            <div className="absolute overflow-clip bottom-0 left-full ml-2 w-48 bg-surface-container rounded-lg shadow-md border border-border" style={{ zIndex: 50 }}>
                                <Link
                                    href="/profile"
                                    onClick={() => setShowDropdown(false)}
                                    className="block px-4 py-2 text-sm text-onsurface-primary hover:bg-surface-container-muted hover:text-onsurface-primary"
                                >
                                    <div className="flex items-center gap-2">
                                        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                        </svg>
                                        View Profile
                                    </div>
                                </Link>

                                {/* Theme Toggle */}
                                <div className="border-t border-border">
                                    <button
                                        onClick={() => {
                                            if (theme === 'light') setTheme('dark');
                                            else if (theme === 'dark') setTheme('system');
                                            else setTheme('light');
                                        }}
                                        className="block w-full text-left px-4 py-2 text-sm text-onsurface-primary hover:bg-surface-container-muted hover:text-onsurface-primary"
                                    >
                                        <div className="flex items-center justify-between">
                                            <div className="flex items-center gap-2">
                                                {theme === 'system' ? (
                                                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                                    </svg>
                                                ) : theme === 'dark' ? (
                                                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                                                    </svg>
                                                ) : (
                                                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                                                    </svg>
                                                )}
                                                <span>Theme</span>
                                            </div>
                                            <span className="text-xs text-onsurface-secondary">
                                                {theme === 'system' ? 'Auto' : theme === 'dark' ? 'Dark' : 'Light'}
                                            </span>
                                        </div>
                                    </button>
                                </div>

                                {/* Feedback Button */}
                                <div className="border-t border-border">
                                    <button
                                        onClick={() => {
                                            setShowDropdown(false);
                                            setShowFeedback(true);
                                        }}
                                        className="block w-full text-left px-4 py-2 text-sm text-onsurface-primary hover:bg-surface-container-muted hover:text-onsurface-primary"
                                    >
                                        <div className="flex items-center justify-between w-full">
                                            <div className="flex items-center gap-2">
                                                <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z" />
                                                </svg>
                                                Send Feedback
                                            </div>
                                            <span className="text-xs text-onsurface-secondary">⌘⇧F</span>
                                        </div>
                                    </button>
                                </div>

                                <div className="border-t border-border">
                                    <button
                                        onClick={handleSignOut}
                                        className="block w-full text-left px-4 py-2 text-sm text-onsurface-primary hover:bg-surface-container-muted hover:text-onsurface-primary"
                                    >
                                        <div className="flex items-center gap-2">
                                            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                                            </svg>
                                            Sign out
                                        </div>
                                    </button>
                                </div>
                            </div>
                        )}
                    </>
                ) : (
                    <Link
                        href="/auth/signin"
                        className="cursor-pointer transition-transform"
                    >
                        <div className="w-8 h-8 rounded-full bg-surface-container-muted flex items-center justify-center text-onsurface-secondary hover:bg-surface-container hover:text-onsurface-primary transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="User-Circle-Single--Streamline-Flex-Remix" height="20" width="20">
                                <desc>
                                    User Circle Single Streamline Icon: https://streamlinehq.com
                                </desc>
                                <g id="user-circle-single--circle-geometric-human-person-single-user">
                                    <path id="Union" fill="currentColor" fillRule="evenodd" d="M4.670468571428571 4.670468571428571C3.0676457142857143 6.273291428571428 2.142857142857143 8.700068571428572 2.142857142857143 12c0 3.2999314285714285 0.9247885714285715 5.726742857142856 2.5276114285714284 7.329599999999999 0.12294857142857143 0.12291428571428571 0.25074857142857143 0.2418857142857143 0.3834342857142857 0.35674285714285714 0.45924 -1.2126857142857144 1.2307714285714284 -2.2908 2.245508571428571 -3.1202571428571426 1.3265657142857143 -1.0842685714285714 2.987177142857143 -1.6765714285714284 4.700485714285715 -1.6765714285714284 1.7132914285714285 0 3.37392 0.5923028571428571 4.700485714285715 1.6765714285714284 1.0147028571428571 0.8294571428571428 1.7863028571428572 1.907742857142857 2.24556 3.120428571428571 0.13268571428571427 -0.11502857142857144 0.26057142857142856 -0.234 0.3836571428571428 -0.3569142857142857C20.93228571428571 17.726742857142856 21.857142857142858 15.299931428571428 21.857142857142858 12s-0.9248571428571428 -5.7267085714285715 -2.527542857142857 -7.3295314285714275C17.726742857142856 3.0676457142857143 15.299931428571428 2.142857142857143 12 2.142857142857143s-5.7267085714285715 0.9247885714285715 -7.3295314285714275 2.5276114285714284ZM12 24c2.6629542857142856 0 4.984611428571428 -0.5415428571428571 6.864685714285715 -1.6352571428571427 0.09994285714285714 -0.03754285714285714 0.18942857142857142 -0.0924 0.2660571428571428 -0.16028571428571428 0.6241714285714285 -0.38931428571428567 1.196742857142857 -0.8423999999999999 1.713942857142857 -1.3597714285714286C22.95771428571428 18.73182857142857 24 15.694354285714285 24 12c0 -3.6943542857142857 -1.0422857142857143 -6.731862857142857 -3.1553142857142857 -8.844754285714286C18.73182857142857 1.0423542857142858 15.694354285714285 0 12 0 8.305645714285715 0 5.268137142857142 1.0423542857142858 3.155245714285714 3.155245714285714S0 8.305645714285715 0 12s1.0423542857142858 6.73182857142857 3.155245714285714 8.844685714285713C5.268137142857142 22.95771428571428 8.305645714285715 24 12 24ZM9.531531428571428 9.244525714285714c0 -0.9355885714285714 0.25981714285714286 -1.515222857142857 0.6065828571428571 -1.8619885714285713 0.34676571428571423 -0.34676571428571423 0.9263999999999999 -0.6065828571428571 1.8619885714285713 -0.6065828571428571s1.515222857142857 0.25981714285714286 1.8619885714285713 0.6065828571428571c0.34676571428571423 0.34676571428571423 0.6065828571428571 0.9263999999999999 0.6065828571428571 1.8619885714285713 0 0.9355714285714285 -0.25981714285714286 1.5152057142857143 -0.6065828571428571 1.8619885714285713 -0.34676571428571423 0.34676571428571423 -0.9263999999999999 0.6065828571428571 -1.8619885714285713 0.6065828571428571s-1.515222857142857 -0.25981714285714286 -1.8619885714285713 -0.6065828571428571c-0.34676571428571423 -0.3467828571428571 -0.6065828571428571 -0.9264171428571427 -0.6065828571428571 -1.8619885714285713Zm2.4685714285714284 -4.611428571428571c-1.3300114285714284 0 -2.520377142857143 0.37738285714285713 -3.3772114285714285 1.234217142857143 -0.8568342857142857 0.8568171428571427 -1.234217142857143 2.047182857142857 -1.234217142857143 3.3772114285714285 0 1.3300114285714284 0.37738285714285713 2.520377142857143 1.234217142857143 3.3772114285714285 0.8568342857142857 0.8568342857142857 2.0471999999999997 1.234217142857143 3.3772114285714285 1.234217142857143 1.3300114285714284 0 2.520377142857143 -0.37738285714285713 3.3772114285714285 -1.234217142857143 0.8568342857142857 -0.8568342857142857 1.234217142857143 -2.0471999999999997 1.234217142857143 -3.3772114285714285 0 -1.3300285714285713 -0.37738285714285713 -2.5203942857142856 -1.234217142857143 -3.3772114285714285 -0.8568342857142857 -0.8568342857142857 -2.0471999999999997 -1.234217142857143 -3.3772114285714285 -1.234217142857143Z" clipRule="evenodd" strokeWidth="1.7143"></path>
                                </g>
                            </svg>
                        </div>
                    </Link>
                )}
            </div>

            {/* AI Command Palette */}
            <AICommandPalette
                isOpen={showAICommand}
                onClose={() => setShowAICommand(false)}
            />

            {/* Feedback Modal */}
            <FeedbackModal
                isOpen={showFeedback}
                onClose={() => setShowFeedback(false)}
            />
        </div>
    );
}